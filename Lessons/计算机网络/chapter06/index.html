
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/Lessons/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/chapter06/">
      
      
        <link rel="prev" href="../chapter05/">
      
      
        <link rel="next" href="../chapter07/">
      
      
      <link rel="icon" href="../../../images/下雪.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.30">
    
    
      
        <title>chapter6 | 传输层 - NoneZJL的个人笔记</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    

      
    
<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#transport-layer" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="NoneZJL的个人笔记" class="md-header__button md-logo" aria-label="NoneZJL的个人笔记" data-md-component="logo">
      
  <img src="../../../images/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NoneZJL的个人笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              chapter6 | 传输层
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NoneZJL/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NoneZJL's notebook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" class="md-tabs__link">
          
  
    
  
  课程

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Tools/mkdocs%E4%BD%BF%E7%94%A8/" class="md-tabs__link">
          
  
    
  
  工具

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  关于我

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NoneZJL的个人笔记" class="md-nav__button md-logo" aria-label="NoneZJL的个人笔记" data-md-component="logo">
      
  <img src="../../../images/logo.jpg" alt="logo">

    </a>
    NoneZJL的个人笔记
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NoneZJL/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NoneZJL's notebook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    课程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            课程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    计算机系统原理
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            计算机系统原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 1 | 计算机抽象及相关技术
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 2 | 指令——计算机的语言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 3 | 计算机的算数运算
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 4 | 处理器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 5 | 大容量和高速度——开发存储器层次结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 6 | 输入输出系统
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    计算机网络
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            计算机网络
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter1 | 引言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter2 | 物理层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter3 | 数据链路层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter4 | 介质访问子层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter5 | 网络层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    chapter6 | 传输层
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    chapter6 | 传输层
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      概述和传输层服务
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      套接字编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="套接字编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#udp" class="md-nav__link">
    <span class="md-ellipsis">
      使用UDP套接字实现回音服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp" class="md-nav__link">
    <span class="md-ellipsis">
      使用TCP套接字实现回音服务
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      传输层复用和分用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="传输层复用和分用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#udp_1" class="md-nav__link">
    <span class="md-ellipsis">
      UDP分用的方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_1" class="md-nav__link">
    <span class="md-ellipsis">
      TCP分用的方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udp_2" class="md-nav__link">
    <span class="md-ellipsis">
      无连接传输：UDP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp_2" class="md-nav__link">
    <span class="md-ellipsis">
      面向连接的传输：TCP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="面向连接的传输：TCP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp_3" class="md-nav__link">
    <span class="md-ellipsis">
      TCP概述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_4" class="md-nav__link">
    <span class="md-ellipsis">
      TCP报文段结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_5" class="md-nav__link">
    <span class="md-ellipsis">
      TCP可靠数据传输
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TCP可靠数据传输">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp_6" class="md-nav__link">
    <span class="md-ellipsis">
      一个高度简化的TCP协议
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crash-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Crash Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_7" class="md-nav__link">
    <span class="md-ellipsis">
      TCP流量控制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_8" class="md-nav__link">
    <span class="md-ellipsis">
      TCP连接管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TCP连接管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      两次握手建立连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      三次握手建立连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_9" class="md-nav__link">
    <span class="md-ellipsis">
      关闭TCP连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      安全问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      理解网络拥塞
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp_10" class="md-nav__link">
    <span class="md-ellipsis">
      TCP拥塞控制
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      拥塞控制的发展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="拥塞控制的发展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp-cubic" class="md-nav__link">
    <span class="md-ellipsis">
      TCP CUBIC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-bbr" class="md-nav__link">
    <span class="md-ellipsis">
      Google BBR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-center-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      Data Center TCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dccp" class="md-nav__link">
    <span class="md-ellipsis">
      DCCP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      传输层协议的发展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="传输层协议的发展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mptcp" class="md-nav__link">
    <span class="md-ellipsis">
      MPTCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quic" class="md-nav__link">
    <span class="md-ellipsis">
      QUIC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter7 | 应用层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter8 | 网络安全
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习碎碎念
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    操作系统
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            操作系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter01 | 介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter02 | OS结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter03 | 进程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter04 | 线程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter05 | 进程调度
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter06 | 进程同步
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter07 | 死锁
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter08 | 内存
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter09 | 虚拟内存
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter10 | 文件系统接口
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter11 | 文件系统实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter12 | 海量存储系统
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter13 | I/O系统
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/mkdocs%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/elasticsearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElasticSearch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/Latex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Latex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Redis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Redis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/Redis/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/Redis/chapter01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis 命令
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于我
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      概述和传输层服务
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      套接字编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="套接字编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#udp" class="md-nav__link">
    <span class="md-ellipsis">
      使用UDP套接字实现回音服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp" class="md-nav__link">
    <span class="md-ellipsis">
      使用TCP套接字实现回音服务
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      传输层复用和分用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="传输层复用和分用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#udp_1" class="md-nav__link">
    <span class="md-ellipsis">
      UDP分用的方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_1" class="md-nav__link">
    <span class="md-ellipsis">
      TCP分用的方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udp_2" class="md-nav__link">
    <span class="md-ellipsis">
      无连接传输：UDP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp_2" class="md-nav__link">
    <span class="md-ellipsis">
      面向连接的传输：TCP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="面向连接的传输：TCP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp_3" class="md-nav__link">
    <span class="md-ellipsis">
      TCP概述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_4" class="md-nav__link">
    <span class="md-ellipsis">
      TCP报文段结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_5" class="md-nav__link">
    <span class="md-ellipsis">
      TCP可靠数据传输
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TCP可靠数据传输">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp_6" class="md-nav__link">
    <span class="md-ellipsis">
      一个高度简化的TCP协议
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crash-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Crash Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_7" class="md-nav__link">
    <span class="md-ellipsis">
      TCP流量控制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_8" class="md-nav__link">
    <span class="md-ellipsis">
      TCP连接管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TCP连接管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      两次握手建立连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      三次握手建立连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp_9" class="md-nav__link">
    <span class="md-ellipsis">
      关闭TCP连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      安全问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      理解网络拥塞
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp_10" class="md-nav__link">
    <span class="md-ellipsis">
      TCP拥塞控制
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      拥塞控制的发展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="拥塞控制的发展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tcp-cubic" class="md-nav__link">
    <span class="md-ellipsis">
      TCP CUBIC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-bbr" class="md-nav__link">
    <span class="md-ellipsis">
      Google BBR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-center-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      Data Center TCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dccp" class="md-nav__link">
    <span class="md-ellipsis">
      DCCP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      传输层协议的发展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="传输层协议的发展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mptcp" class="md-nav__link">
    <span class="md-ellipsis">
      MPTCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quic" class="md-nav__link">
    <span class="md-ellipsis">
      QUIC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="transport-layer">Transport layer</h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8V2m6.78 1a.69.69 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38-2.5-2.5Z"/></svg></span> 约 12076 个字 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11l-3.54-4.71Z"/></svg></span> 56 张图片 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3L12.5 13Z"/></svg></span> 预计阅读时间 81 分钟</p>
</div>
<h2 id="_1">概述和传输层服务</h2>
<p><strong>传输层的位置</strong></p>
<ul>
<li>传输层位于网络层和应用层之间 - 基于网络层提供的服务，向分布式应用程序提供通信服务</li>
<li>按照因特网的“端到端”设计原则 - 应用程序只运行在终端上，即不需要为网络设备编写程序</li>
<li>站在应用程序的角度 - 传输层应提供进程之间本地通信的抽象：即运行在不同终端上的应用进程仿佛是直接连在一起的</li>
</ul>
<div class="admonition note">
<p class="admonition-title">作为应用程序的开发者，看到的就是传输层的内容，更下层的内容对于开发者来说是不可见的</p>
</div>
<p><strong>不同终端上的进程间的通信</strong></p>
<p>在TCP/IP网络中，使用<font color="red">套接字(socket)</font>进行通信，这是应用层和传输层的接口，也是应用程序和网络之间的API</p>
<p><strong>传输层提供的服务</strong></p>
<ul>
<li>网络层提供“尽力而为”的服务</li>
<li>传输层提供“有所为、有所不为”的服务<ol>
<li>传输层可以通过差错恢复、重排序等手段提供可靠、按序的交付服务</li>
<li>但传输层无法提供延迟保证、带宽保证等服务</li>
</ol>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">因特网传输层提供的服务</p>
<ul>
<li>最低限度的传输服务：<ol>
<li>将终端-终端的数据交付扩展到进程 - 进程的数据交付</li>
<li>报文检错</li>
</ol>
</li>
<li>增强服务：<ol>
<li>可靠数据传输</li>
<li>流量控制</li>
<li>拥塞控制</li>
</ol>
</li>
<li>因特网传输层通过UDP协议和TCP协议，向应用层提供两种不同的传输服务：<ol>
<li>UDP协议：仅提供最低限度的传输服务</li>
<li>TCP协议：提供基础服务和增强服务</li>
</ol>
</li>
</ul>
</div>
<h2 id="_2">套接字编程</h2>
<p><strong>应用程序体系结构</strong></p>
<ul>
<li>传统及主流的是客户-服务器体系结构(C/S)</li>
<li>有一台总是在线的主机，运行一个服务器程序(server)，服务器主机具有永久的、众所周知的地址</li>
<li>用户终端上运行一个客户程序（client），需要时主动与服务器程序通信，请求服务</li>
<li>客户只与服务器通信，客户之间不通信</li>
</ul>
<div class="admonition note">
<p class="admonition-title">进程使用端口号来标识自己(主机地址+端口号)</p>
</div>
<p><strong>应用编程接口：socket API</strong></p>
<ul>
<li>应用需显式地创建、使用和释放套接字</li>
<li>采用客户-服务器模式：<ol>
<li>客户总是主动发起通信的一方，服务器始终在等待客户的服务请求到来</li>
</ol>
</li>
<li>应用可以通过socket API调用两种传输服务: <ol>
<li>不可靠的数据报服务：由UDP协议实现</li>
<li>可靠的字节流服务：由TCP协议实现</li>
</ol>
</li>
</ul>
<p><strong>套接字传输层协议</strong></p>
<p><img alt="a" src="../photos/2024112101.png" width="500px" /></p>
<ul>
<li>type指明传输层协议<ol>
<li>SOCK_STREAM代表TCP字节流</li>
<li>SOCK_DGRAM代表UDP数据报</li>
</ol>
</li>
</ul>
<p><strong>套接字描述符</strong></p>
<ul>
<li>Linux系统中程序通过访问套接字描述符来进行套接字通信</li>
<li>在套接字描述符上的发送、接收数据的行为可以用<font color="red">文件读写</font>调用完成<ol>
<li>read从描述符fd中读取(接收)长度为返回值的字节数至buf中</li>
<li>write向描述符fd中写入(发送)buf中长度为返回值的字节数</li>
</ol>
</li>
</ul>
<p><img alt="a" src="../photos/20241121110814.png" width="400px" /></p>
<h3 id="udp">使用UDP套接字实现回音服务</h3>
<p><strong>绑定套接字地址 - bind()</strong></p>
<ul>
<li>用来将服务器本地套接字地址sa与描述符socket_fd绑定</li>
<li>客户程序不需要调用bind()，操作系统将为其在1024～5000之间分配一个端口号</li>
</ul>
<p><img alt="a" src="../photos/20241121110950.png" width="400px" /></p>
<p><strong>关闭套接字 - close()</strong></p>
<ul>
<li>当实参fd为TCP套接字描述符时<ul>
<li>调用close()会引起本地进程向远程进程发送关闭连接的消息</li>
</ul>
</li>
<li>当实参fd为UDP套接字描述符时<ul>
<li>调用close()会引起为此描述符分配的资源被内核释放</li>
</ul>
</li>
</ul>
<p><img alt="a" src="../photos/20241121111152.png" width="350px" /></p>
<p><strong>基于UDP的套接字通信流程</strong></p>
<p><img alt="a" src="../photos/20241121141653.png" width="500px" /></p>
<details class="note">
<summary>UDP代码实现</summary>
<p>服务端代码</p>
<p><img alt="a" src="../photos/20241121141854.png" width="500px" /></p>
<p>首先创建socket对象，参数为使用IPv4地址以及使用UDP服务。接着设置服务地址，包括设置IPv4、可以接收来自任何IP地址的信息以及端口，然后将刚刚设置的地址信息与前面创建的socket信息绑定。最后就可以进入循环，在循环中不断的接收客户端发来的信息并且将元信息返回。</p>
<p>客户端代码</p>
<p><img alt="a" src="../photos/20241121142434.png" width="450px" /></p>
<p><img alt="a" src="../photos/20241121142608.png" width="500px" /></p>
<p>同样的，首先创建socket对象，参数为使用IPv4地址以及使用UDP服务。接着设置服务地址信息，包括设置IPv4、设置接收信息的服务器为IPv4地址以及端口信息。最后就可以向服务器发送信息，然后接收信息并且将接收到的信息进行打印。</p>
</details>
<h3 id="tcp">使用TCP套接字实现回音服务</h3>
<p>使用TCP套接字编程时，可将TCP连接想像成一对套接字之间的一条封闭管道</p>
<ul>
<li>发送端TCP将要发送的字节序列从管道的一(套接字)送入</li>
<li>接收端TCP从管道的另一端(套接字)取出字节序列</li>
<li>在管道中传输的字节不丢失，并保持顺序</li>
</ul>
<p><strong>服务器使用多个套接字服务客户</strong></p>
<ul>
<li>服务器进程在<font color="red">监听套接字</font>上等待客户的连接请求</li>
<li>客户进程创建一个本地套接字，与服务器的监听套接字通信<ol>
<li>在此过程中，客户TCP向服务器TCP发送连接请求</li>
</ol>
</li>
<li>收到连接请求后，服务器进程创建一个<font color="red">临时套接字(称连接套接字)</font>和一个新的服务器进程，与客户进程通信</li>
<li>服务器进程回到监听套接字上继续等待<ol>
<li>此举<font color="blue">允许服务器同时服务多个客户</font></li>
</ol>
</li>
<li>客户服务结束后，服务器销毁进程，关闭连接套接字</li>
</ul>
<p><strong>TCP服务器监听套接字 - listen()</strong></p>
<ul>
<li>将主动套接字转变为被动套接字，进入监听状态</li>
<li>backlog设定了监听队列长度(也就是最大能够同时支持的连接数)</li>
</ul>
<p><img alt="a" src="../photos/20241121143817.png" width="450px" /></p>
<p><strong>TCP套接字系统调用 - accept()</strong></p>
<ul>
<li>服务端从已建立连接的队列中出队列一个客户端</li>
<li>返回值是用来和客户端交换数据的套接字描述符，需要在通信完毕后调用close关闭</li>
<li>返回时客户端的IP地址和端口可在cliaddr中访问</li>
</ul>
<p><img alt="a" src="../photos/20241121144012.png" width="450px" /></p>
<p><strong>TCP套接字系统调用 - connect()</strong></p>
<ul>
<li>客户端调用connect向服务器发起建立连接的请求</li>
<li>服务器的IP地址和端口信息在servaddr中</li>
<li>三次握手的过程导致connect的调用是阻塞的</li>
</ul>
<p><img alt="a" src="../photos/20241121144141.png" width="500px" /></p>
<p><strong>基于TCP的套接字通信流程</strong></p>
<p><img alt="a" src="../photos/20241121144409.png" width="450px" /></p>
<details class="note">
<summary>TCP代码实现</summary>
<p>服务端代码</p>
<p><img alt="a" src="../photos/20241121144600.png" width="500px" /></p>
<p><img alt="a" src="../photos/20241121144654.png" width="400px" /></p>
<p>客户端代码</p>
<p><img alt="a" src="../photos/20241121144745.png" width="500px" /></p>
<p><img alt="a" src="../photos/20241121144819.png" width="500px" /></p>
<p>这两份代码的实现都与UDP的代码实现类似，只是多了connect部分</p>
</details>
<h2 id="_3">传输层复用和分用</h2>
<p><strong>复用和分用定义</strong></p>
<ul>
<li>(发送端)复用:传输层从多个套接字收集数据，交给网络层发送</li>
<li>(接收端)分用:传输层将从网络层收到的数据，交付给正确的套接字</li>
</ul>
<p><strong>套接字标识与端口号</strong></p>
<p><img alt="a" src="../photos/20241121145624.png" width="300px" /></p>
<ul>
<li>端口号是套接字标识的一部分：每个套接字在本地关联一个端口号，端口号是一个16比特的数</li>
<li>端口号的分类：<ol>
<li>熟知端口：0~1023，由公共域协议使用</li>
<li>注册端口：1024~49151，需要向IANA注册才能使用</li>
<li>动态和/或私有端口：49152~65535，一般程序使用</li>
</ol>
</li>
<li>报文段中有两个字段携带端口号<ol>
<li>源端口号：与发送进程关联的本地端口号</li>
<li>目的端口号：与接收进程关联的本地端口号</li>
</ol>
</li>
</ul>
<p><strong>套接字端口号的分配</strong></p>
<ul>
<li>自动分配(通常客户端使用)：创建套接字时不指定端口号，由操作系统从49152~65535中分配</li>
<li>使用指定端口号创建套接字(通常服务器使用)：创建套接字时指定端口号，实现公共域协议的服务器应分配众所周知的端口号(0~1023)</li>
</ul>
<h3 id="udp_1">UDP分用的方法</h3>
<p><font color="red">UDP套接字使用&lt;IP地址，端口号&gt;二元组进行标识</font></p>
<p>接收方传输层收到一个UDP报文段后，检查报文段中的目的端口号，将UDP报文段交付到具有该端口号的套接字，是要目的IP地址已目的端口号相同，就会交到同一个套接字，与源IP地址与源端口号无关，源IP地址与源端口号仅用在发送响应报文中</p>
<h3 id="tcp_1">TCP分用的方法</h3>
<p><font color="red">连接套接字需要使用&lt;源IP地址，目的IP地址，源端口号，目的端口号&gt;四元组进行标识</font></p>
<ul>
<li>一个TCP服务器为了同时服务很多个客户，使用两种套接字</li>
<li>监听套接字：服务器平时在监听套接字上等待客户的连接请求，该套接字具有众所周知的端口号</li>
<li>连接套接字：服务器在收到客户的连接请求后，创建一个连接套接字，使用临时分配的端口号。同时创建一个新的进程，在该连接套接字上服务该客户<ul>
<li>每个连接套接字只与一个客户通信(与目的IP地址及目的端口号、源IP地址及源端口号都有关)</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">小结</p>
<ul>
<li>UDP套接字<ol>
<li>使用&lt;IP地址，端口号&gt;二元组标识UDP套接字</li>
<li>服务器使用一个套接字服务所有客户</li>
</ol>
</li>
<li>TCP套接字<ol>
<li>使用&lt;源IP地址，目的IP地址，源端口号，目的端口号&gt;四元组标识连接套接字</li>
<li>服务器使用一个监听套接字和多个连接套接字服务多个客户，每个连接套接字服务一个客户</li>
</ol>
</li>
</ul>
</div>
<h2 id="udp_2">无连接传输：UDP</h2>
<p><strong>UDP提供的服务</strong></p>
<p>UDP提供的服务：进程到进程之间的报文交付；报文完整性检查(可选)：检测并丢弃出错的报文。</p>
<p>UDP需要实现的功能：复用和分用。报文检错</p>
<p><strong>UDP报文段结构</strong></p>
<p><img alt="a" src="../photos/20241121151101.png" width="250px" /></p>
<ul>
<li>UDP报文：报头(携带协议处理需要的信息)、载荷(payload - 携带上层数据)</li>
<li>用于复用和分用的字段：源端口号、目的端口号</li>
<li>用于检测报文错误的字段：报文总长度、校验和(checksum)</li>
</ul>
<p><strong>UDP校验和计算</strong></p>
<p><img alt="a" src="../photos/20241121151602.png" width="400px" /></p>
<ul>
<li>计算UDP校验和时，要包括伪头(从IP中获得的信息)、UDP头和数据三个部分</li>
<li>UDP伪头信息取自IP报头，包括：源IP地址，目的IP地址，UDP的协议号，UDP报文段总长度</li>
<li>计算校验和时包含伪头信息，是为了避免由于IP地址错误等造成的误投递</li>
<li>UDP校验和的使用是可选的，若不计算校验和，该字段填入0</li>
</ul>
<details class="question">
<summary>为什么需要UDP</summary>
<ul>
<li>应用可以尽可能快地发送报文：①无建立连接的延迟②不限制发送速率（不进行拥塞控制和流量控制）</li>
<li>报头开销小</li>
<li>协议处理简单</li>
</ul>
<div class="admonition note">
<p class="admonition-title">UDP适合的应用</p>
<ul>
<li>容忍丢包但对延迟敏感的应用：如流媒体</li>
<li>以单次请求/响应为主的应用：如DNS</li>
<li>若应用要求基于UDP进行可靠传输：由应用层实现可靠性</li>
</ul>
</div>
</details>
<h2 id="tcp_2">面向连接的传输：TCP</h2>
<h3 id="tcp_3">TCP概述</h3>
<ul>
<li>TCP服务模型：在一对通信的进程之间提供一条理想的<font color=red">字节流</font>管道</li>
<li>点对点通信、全双工</li>
<li>可靠、有序的字节流：不保留报文边界</li>
</ul>
<div class="admonition note">
<p class="admonition-title">需要的机制</p>
<ul>
<li>建立连接：通信双方为本次通信建立数据传输所需的状态(套接字、缓存、变量等)</li>
<li>可靠数据传输：流水线式发送，报文段检错，丢失重传</li>
<li>流量控制：发送方不会令接收方缓存溢出</li>
</ul>
</div>
<h3 id="tcp_4">TCP报文段结构</h3>
<p><img alt="a" src="../photos/20241121152442.png" width="500px" /></p>
<p><strong>重要的TCP选项</strong></p>
<ul>
<li>最大段长度(MSS)<ol>
<li>TCP段中可以携带的最大数据字节数</li>
<li>建立连接时，每个主机可声明自己能够接受的MSS，缺省为536字节</li>
</ol>
</li>
<li>窗口比例因子(window scale)：<ol>
<li>建立连接时，双方可以协商一个窗口比例因子</li>
<li>实际接收窗口大小 = window size * 2^window scale</li>
</ol>
</li>
<li>选择确认(SACK)：<ol>
<li>最初的TCP协议只使用累积确认</li>
<li>改进的TCP协议引入选择确认，允许接收端指出缺失的数据字节</li>
</ol>
</li>
</ul>
<p><strong>发送序号和确认序号的含义</strong></p>
<p><img alt="a" src="../photos/20241121152921.png" width="500px" /></p>
<div class="admonition warning">
<p class="admonition-title">初始序号的选取: 每个TCP实体维护一个32位计数器，该计数器每4微秒增1，建立连接时从中读取计数器当前值</p>
</div>
<h3 id="tcp_5">TCP可靠数据传输</h3>
<p><strong>概述</strong></p>
<ul>
<li>基本机制<ol>
<li>发送端：流水线式发送数据、等待确认、超时重传</li>
<li>接收端：进行差错检测，采用累积确认机制</li>
</ol>
</li>
<li>乱序段处理：协议没有明确规定<ol>
<li>接收端不缓存：可以正常工作，处理简单，但效率低</li>
<li>接收端缓存：效率高，但处理复杂</li>
</ol>
</li>
</ul>
<h4 id="tcp_6">一个高度简化的TCP协议</h4>
<p>仅考虑可靠传输机制，且数据仅在一个方向上传输</p>
<ul>
<li>接收方<ol>
<li>确认方式：采用累积确认，仅在正确、按序收到报文段后，更新确认序号；其余情况，重复前一次的确认序号(与GBN类似)</li>
<li>失序报文段处理：缓存失序的报文段(与SR类似)</li>
</ol>
</li>
<li>发送方<ol>
<li>发送策略：流水线式发送报文段</li>
<li>定时器的使用：仅对最早未确认的报文段使用一个重传定时器(与GBN类似)</li>
<li>重发策略：仅在超时后重发最早未确认的报文段(与SR类似，因为接收端缓存了失序的报文段)</li>
</ol>
</li>
</ul>
<p><strong>TCP发送方要处理的事件</strong></p>
<ul>
<li>收到应用数据<ol>
<li>创建并发送TCP报文段</li>
<li>若当前没有定时器在运行(没有已发送、未确认的报文段)，启动定时器</li>
</ol>
</li>
<li>超时<ol>
<li>重传包含最小序号的、未确认的报文段</li>
<li>重启定时器</li>
</ol>
</li>
<li>收到ACK<ol>
<li>如果确认序号大于基序号(已发送未确认的最小序号)<ol>
<li>推进发送窗口(更新基序号)</li>
<li>如果发送窗口中还有未确认的报文段，启动定时器，否则终止定时器</li>
</ol>
</li>
</ol>
</li>
</ul>
<p><strong>TCP可能的重传场景</strong></p>
<p><img alt="a" src="../photos/20241121153730.png" width="600px" /></p>
<div class="admonition note">
<p class="admonition-title">TCP为了减少不必要的重传采用的机制</p>
<ul>
<li>只使用一个定时器，避免了超时设置过小时重发大量报文段</li>
<li>利用流水式发送和累积确认，可以避免重发某些丢失了ACK的报文段</li>
</ul>
</div>
<p><strong>超时值的设置</strong></p>
<p>若超时值太小，容易产生不必要的重传；若超时值太大，则丢包恢复的时间太长。直观上，超时值应大于RTT，但RTT是变化的。</p>
<div class="admonition question">
<p class="admonition-title">如何估计RTT？</p>
<ul>
<li>RTT是变化的，需要实时测量从发出某个报文段到收到其确认报文段之间经过的时间(称SampleRTT)</li>
<li>由于SampleRTT波动很大，更有意义的是计算其平均值(称EstimatedRTT)</li>
<li>平均RTT的估算方法(指数加权移动平均)<ol>
<li>EstimatedRTT = (1- α)*EstimatedRTT + α*SampleRTT (典型地，α = 0.125)</li>
</ol>
</li>
<li>瞬时RTT和平均RTT有很大的偏差<ol>
<li>需要在EstimtedRTT 上加一个“安全距离”，作为超时值</li>
<li>安全距离的大小与RTT的波动幅度有关</li>
</ol>
</li>
<li>估算SampleRTT 与 EstimatedRTT的偏差(称DevRTT)<ol>
<li>DevRTT = (1-β)*DevRTT + β*|SampleRTT-EstimatedRTT| (典型地， β = 0.25)</li>
</ol>
</li>
<li>设置重传定时器的超时值 TimeoutInterval = EstimatedRTT + 4*DevRTT</li>
</ul>
</div>
<p><strong>TCP确认的二义性</strong></p>
<ul>
<li>TCP确认的二义性问题：重传的TCP报文段使用与原报文段相同的序号,发送端收到确认后 ，无法得知是对哪个报文段进行的确认</li>
<li>二义性确认带来的问题：对重传报文段测量的SampleRTT，可能不准确</li>
<li>解决方法：忽略有二义性的确认，只对一次发送成功的报文段测量SampleRTT ，并更新EstimtedRTT。当TCP重传一个段时，停止测量SampleRTT</li>
</ul>
<p><strong>定时器补偿</strong></p>
<ul>
<li>简单忽略重传报文段的问题：重传意味着超时值可能偏小了，需要增大。若简单忽略重传报文段(不更新EstimtedRTT)，则超时值也不会更新，超时设置过小的问题没有解决</li>
<li>解决方法：<ol>
<li>采用定时器补偿策略，发送方每重传一个报文段，就直接将超时值增大一倍(不依赖于RTT的更新)</li>
<li>若连续发生超时事件，超时值呈指数增长（至一个设定的上限值）</li>
</ol>
</li>
</ul>
<p><strong>Karn算法</strong></p>
<p>Karn算法结合使用RTT估计值和定时器补偿策略确定超时值</p>
<ul>
<li>使用EstimatedRTT估计初始的超时值</li>
<li>若发生超时，每次重传时对定时器进行补偿，直到成功传输一个报文段为止</li>
<li>若收到上层应用数据、或某个报文段没有重传就被确认了，用最近的EstimatedRTT估计超时值</li>
</ul>
<p><strong>TCP的接收端</strong></p>
<ul>
<li>理论上，接收端只需区分两种情况：<ol>
<li>收到期待的报文段：发送更新的确认序号</li>
<li>其它情况：重复当前的确认序号</li>
</ol>
</li>
<li>为减小通信量，TCP允许接收端推迟确认：<ol>
<li>接收端可以在收到若干个报文段后，发送一个累积确认的报文段</li>
</ol>
</li>
<li>推迟确认带来的问题：<ol>
<li>若延迟太大，会导致不必要的重传</li>
<li>推迟确认造成RTT估计不准确</li>
</ol>
</li>
<li>TCP协议规定：<ol>
<li>推迟确认的时间最多为500ms</li>
<li>接收方至少每隔一个报文段使用正常方式进行确认</li>
</ol>
</li>
</ul>
<p>TCP接收端的事件和处理</p>
<p><img alt="a" src="../photos/20241121155229.png" width="600px" /></p>
<p><strong>快速重传</strong></p>
<ul>
<li>发送方可利用重复ACK检测报文段丢失：<ol>
<li>发送方通常连续发送许多报文段</li>
<li>若仅有个别报文段丢失，发送方将收到多个重复序号的ACK</li>
<li>多数情况下IP按序交付分组，重复ACK极有可能因丢包产生</li>
</ol>
</li>
<li>TCP协议规定：<ol>
<li>当发送方收到对同一序号的3次重复确认时，立即重发包含该序号的报文段</li>
</ol>
</li>
<li>快速重传：就是在定时器到期前重发丢失的报文段</li>
</ul>
<p>快速重传算法实现</p>
<p><img alt="a" src="../photos/20241121160730.png" width="500px" /></p>
<details class="note">
<summary>TCP与一些其他协议的对比</summary>
<p><img alt="a" src="../photos/20241121160916.png" width="500px" /></p>
<p><img alt="a" src="../photos/20241121160948.png" width="500px" /></p>
<p>TCP结合了GBN和SR的优点</p>
<ul>
<li>定时器的使用：与GBN类似，只对最早未确认的报文段使用一个定时器</li>
<li>超时重传：与SR类似，只重传缺失的数据</li>
</ul>
<p><font color="red">TCP在减小定时器开销和重传开销方面要优于GBN和SR！</font></p>
</details>
<h3 id="crash-recovery">Crash Recovery</h3>
<p>从host crash的恢复是困难的。</p>
<p>当一个主机crash掉的时候，客户端可能有两种状态</p>
<ul>
<li>S0 -&gt; 没有数据段(ack)在传输中</li>
<li>S1 -&gt; 有数据段(ack)在传输中。</li>
</ul>
<p><strong>一些解决方式</strong></p>
<ul>
<li>当客户端得知崩溃时，只有其存在没有传输到的ack时，才会进行重传</li>
<li>如果在崩溃发生的时候，ack已经发出了，但是数据还没有写入到磁盘中，客户端就会收到ack信号并且处于S0状态。(导致LOST问题)</li>
<li>如果在崩溃发生的时候，数据写入磁盘已经完成了，但是ack信号还没有发出，客户端就会没有收到ack信号因而处于S1状态。(导致Dup问题)</li>
</ul>
<p><img alt="a" src="../photos/20241121162521.png" width="500px" /></p>
<details class="question">
<summary>能否通过总是重传以及使用序列号的方式来避免重复的情况？</summary>
<p>取决于能不能向上层询问信息，如果能够向上层询问缓存信息，获得数据段传输的情况，就可以实现。仅仅通过自己本层的服务是无法实现的。</p>
<div class="admonition danger">
<p class="admonition-title">更加笼统的来说，想要从一个N层的crash恢复，一定需要N+1或者更高层的服务提供信息来进行状态保持</p>
</div>
</details>
<h3 id="tcp_7">TCP流量控制</h3>
<p><strong>TCP的接收端 - 接收缓存</strong></p>
<ul>
<li>TCP接收端有一个接收缓存：接收端TCP将收到的数据放入接收缓存，应用进程从接收缓存中读数据。但是进入接收缓存的数据不一定被立即取走、取完，如果接收缓存中的数据未及时取走，后续到达的数据可能会因缓存溢出而丢失</li>
<li>流量控制：发送端TCP通过调节发送速率，不使接收端缓存溢出</li>
</ul>
<div class="admonition note">
<p class="admonition-title">为什么GBN/SR和UDP不需要流量控制</p>
<ul>
<li>GBN和SR<ol>
<li>GBN和SR均假设：①正确、按序到达的分组被立即交付给上层②其占用的缓冲区被立即释放</li>
<li>发送方根据确认序号即可知道：①哪些分组已被移出接收窗口②接收窗口还可以接受多少分组</li>
<li>因此GBN和SR不需要流量控制</li>
</ol>
</li>
<li>UDP<ol>
<li>接收端UDP将收到的报文载荷放入接收缓存</li>
<li>应用进程每次从接收缓存中读取一个完整的报文载荷</li>
<li>当应用进程消费数据不够快时，接收缓存溢出，报文数据丢失，UDP不负责任</li>
<li>因此UDP不需要流量控制</li>
</ol>
</li>
</ul>
</div>
<p><strong>TCP的流量控制</strong></p>
<ul>
<li>接收缓存中的可用空间称为接收窗口：RcvWindow = RcvBuffer - [LastByteRcvd -LastByteRead]</li>
<li>接收方将RcvWindow放在报头中，向发送方通告接收缓存的可用空间</li>
<li>发送方限制未确认的字节数不超过接收窗口的大小，即：LastByteSent-LastByteAcked ≦ RcvWindow</li>
<li>特别是，当接收方通告接收窗口为0时，发送方必须停止发送</li>
</ul>
<p><img alt="a" src="../photos/20241121170743.png" width="350px" /></p>
<div class="admonition danger">
<p class="admonition-title">可能会导致死锁问题</p>
<p><img alt="a" src="../photos/20241121170911.png" width="500px" /></p>
<p>第16步执行完成之后，因为B发送给A的数据丢失了，所以A仍然认为B没有接收窗口，所以一直不会发送数据给B，而B一直接收不到A的数据，就认为A的数据已经全部发送完成了，也不会给A发送数据，此时也就陷入了死锁。</p>
<div class="admonition answer">
<p class="admonition-title">解决方式：非零窗口通告</p>
<p>TCP协议规定：发送方收到“零窗口通告”后，可以发送“零窗口探测”报文段，从而接收方可以发送包含接收窗口的响应报文段。</p>
</div>
</div>
<p><strong>零窗口探测的实现</strong></p>
<ul>
<li>发送端收到零窗口通告时，启动一个坚持定时器</li>
<li>定时器超时后，发送端发送一个零窗口探测报文段(序号为上一个段中最后一个字节的序号)</li>
<li>接收端在响应的报文段中通告当前接收窗口的大小</li>
<li>若发送端仍收到零窗口通告，重新启动坚持定时器</li>
</ul>
<p><strong>糊涂窗口综合症</strong></p>
<p>当数据的发送速度很快、而消费速度很慢时，零窗口探测的简单实现带来以下问题：</p>
<ul>
<li>接收方不断发送微小窗口通告</li>
<li>发送方不断发送很小的数据分组</li>
<li>大量带宽被浪费</li>
</ul>
<div class="admonition success">
<p class="admonition-title">解决方案</p>
<ul>
<li>接收方启发式策略</li>
<li>发送方启发式策略</li>
</ul>
</div>
<p><strong>接收方启发式策略</strong></p>
<p>接收方通知零窗口后，仅当窗口大小<font color="red">显著增加</font>(窗口大小达到缓存空间的一半或者一个MSS[最大包长度]，取两者的较小值)之后才发送更新的窗口通告</p>
<div class="admonition note">
<p class="admonition-title">TCP执行该策略的做法</p>
<ul>
<li>当窗口大小不满足以上策略时，推迟发送确认(但最多推迟500ms，且至少每隔一个报文段使用正常方式进行确认)，寄希望于推迟间隔内有更多数据被消费</li>
<li>仅当窗口大小满足以上策略时，才通告新的窗口大小</li>
</ul>
</div>
<p><strong>发送方启发式策略</strong></p>
<p>发送方应积聚足够多的数据再发送，以防止发送太短的报文段</p>
<div class="admonition question">
<p class="admonition-title">发送方应等待多长时间？</p>
<ul>
<li>若等待时间不够，报文段会太短</li>
<li>若等待时间过久，应用程序的时延会太长</li>
<li>更重要的是，<font color="red">TCP不知道应用程序会不会在最近的将来生成更多的数据</font></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nagle算法</p>
<ul>
<li>算法实现<ol>
<li>在新建连接上，当应用数据到来时，组成一个TCP段发送(那怕只有一个字节)</li>
<li>在收到确认之前，后续到来的数据放在发送缓存中</li>
<li>当数据量达到一个MSS或上一次传输的确认到来(取两者的较小时间)，用一个TCP段将缓存的字节全部发走</li>
</ol>
</li>
<li>算法优点<ol>
<li>适应网络延时、MSS长度及应用速度的各种组合</li>
<li>常规情况下不会降低网络的吞吐量</li>
</ol>
</li>
</ul>
</div>
</div>
<h3 id="tcp_8">TCP连接管理</h3>
<h4 id="_4">两次握手建立连接</h4>
<p>不靠谱的网路中会出现的意外(包的延迟与丢失)：</p>
<ol>
<li>包传输延迟变化很大</li>
<li>存在重传的报文段</li>
<li>存在报文重排序</li>
</ol>
<p><strong>两次握手失败情况</strong></p>
<p><img alt="a" src="../photos/20241128100031.png" width="500px" /></p>
<p>网路中不同包的到达顺序不是严格的，导致服务端接收包的顺序出错或者收到很久以前的包而出错</p>
<p><strong>解决方式</strong></p>
<p>在包上写序列号，如果收到的包的序列号见过，那么就丢掉这个包</p>
<ul>
<li>问题<ol>
<li>但是序列号的长度是有限的，很快会重复</li>
<li>重新建立连接后序列号又会重新开始，还是会产生二义性</li>
</ol>
</li>
<li>解决方式：使用时间，时间的长度会长一些，然后设置包在网络中的存活时间小于一轮时间周期。<ol>
<li>收到包后，需要判断包的序列号，如果这个包以前见过并且间隔时间小于一轮时间，就丢掉，否则就算是见过也会接收</li>
<li>使用包的存活时间(TTL)来实现包的存活时间控制</li>
<li>解决crash问题(crash之后包的序号会强行刷新)：使用 time-of-the-day clock，无论是否crash，这个时钟都会增长，然后每一个连接的输出的序列号都根据这个时钟来决定。这个时钟的长度一般会大于32个字节，使用的时候取它的低32字节即可。</li>
</ol>
</li>
<li>基于时钟的起始序号选取算法<ol>
<li>这个时钟每4微秒增长1</li>
<li>新建连接时，以本地计数器值得最低32为作为起始序列号</li>
<li>使用得字节序号较长(32bit)，回绕时间大于数据报在网络上的寿命时长 </li>
</ol>
</li>
<li>发包的速度也有限制<ol>
<li>因为时钟是自主增长的，但是发包中的序列号的增长速度是由发包的速度决定的</li>
<li>如果发包的速度过快，那么下一轮发送的起始序列号可能已经在上一轮中用过，并且此时两个包的发送的间隔时间小于一轮时间周期(最快一个tick一个segment)                <br />
<img alt="a" src="../photos/20241128102950.png" width="500px" /></li>
<li>但是发包速度过慢也可能会产生问题   <br />
<img alt="a" src="../photos/20241128103516.png" width="300px" /></li>
</ol>
</li>
</ul>
<h4 id="_5">三次握手建立连接</h4>
<p><img alt="a" src="../photos/20241128103732.png" width="500px" /></p>
<div class="admonition note">
<p class="admonition-title">syn信号就是connection request信号，syn数据包中不包含数据</p>
</div>
<div class="admonition warning">
<p class="admonition-title">客户端的起始序列号是由客户端的本地时钟决定的，服务器的起始序列号是由服务器的本地时钟决定的，两者之间没有关系</p>
</div>
<h4 id="tcp_9">关闭TCP连接</h4>
<p><strong>异步释放</strong></p>
<p>一次性全部释放，可能会存在问题</p>
<p><img alt="a" src="../photos/20241128104557.png" width="250px" /></p>
<p><strong>同步释放(四次挥手)</strong></p>
<p><img alt="a" src="../photos/20241128104719.png" width="500px" /></p>
<p>存在的问题(The two army problem)：山谷中有白色方，山谷两侧是蓝色方，蓝色方单打打不过白色方，但是结合就打得过，因而山谷两侧的蓝色方需要联合：</p>
<ul>
<li>蓝色1给蓝色2一个通信兵告知消息</li>
<li>蓝色2收到消息后需要让蓝色1知道它知道了</li>
<li>蓝色1知道蓝色2知道后需要让蓝色2知道蓝色1知道蓝色2知道了</li>
<li>......</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">这个问题在双边通信中无法解决的(除非面对面通信)</p>
</div>
<p><strong>客户/服务器经历的TCP状态序列</strong></p>
<p><img alt="a" src="../photos/20241128105628.png" width="500px" /></p>
<h4 id="_6">安全问题</h4>
<p><strong>SYN泛洪攻击</strong></p>
<ul>
<li>TCP中实现：<ol>
<li>服务器在收到SYN段后，发送SYNACK段，分配资源</li>
<li>若未收到ACK段，服务器超时后重发SYNACK段</li>
<li>服务器等待一段时间(称SYN超时)后丢弃未完成的连接，SYN超时的典型值为30秒~120秒</li>
</ol>
</li>
<li>SYN泛洪攻击：<ol>
<li>攻击者采用伪造的源IP地址，向服务器发送大量的SYN段，却不发送ACK段</li>
<li>服务器为维护一个巨大的半连接表耗尽资源，导致无法处理正常客户的连接请求，表现为服务器停止服务</li>
</ol>
</li>
</ul>
<div class="admonition success">
<p class="admonition-title">一种可能的解决方式：在SYN之后添加随机数，使得最终哈希出的结果的前六位为0，也就是增加发送方发送SYN请求的代价，但是服务器很容易验证</p>
</div>
<p><strong>TCP端口扫描</strong></p>
<p>扫描目标机器的不同端口，看目标机器会不会会ACK，如果回了(SYNACK说明目标端口上有服务在运行，RST说明目标端口上没有服务在运行，什么都没收到说明有防火墙)就说明目标机器的该端口提供服务，然后根据对方服务的端口来判断对方提供的服务类型</p>
<h2 id="_7">理解网络拥塞</h2>
<ul>
<li>起因：大量分组短时间内进入网络，超出网络的处理能力</li>
<li>表现：分组延迟增大，网络吞吐量下降，甚至降为0</li>
<li>措施：减少分组进入网络(拥塞控制)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">流量控制与拥塞控制的异同</p>
<ul>
<li>流量控制：限制发送速度，使不超过<font color="red">接收端</font>的处理能力</li>
<li>拥塞控制：限制发送速度，使不超过<font color="red">网络</font>的处理能力</li>
</ul>
</div>
<p><strong>网络拥塞的后果</strong></p>
<p>会导致丢包(由路由器缓存溢出造成)以及分组延迟增大(链路接近满载造成)，此时大量网络资源用于重传丢失的分组、(不必要)延迟过大的分组以及最终被丢弃的分组，最终导致进入网络的负载很重，网络吞吐量却很低</p>
<p><strong>拥塞控制的常用方法</strong></p>
<ul>
<li>网络辅助的拥塞控制<ul>
<li>路由器向端系统提供显式的反馈，例如：<ol>
<li>设置拥塞指示比特</li>
<li>给出发送速率指示</li>
</ol>
</li>
<li>ATM、X.25采用此类方法</li>
</ul>
</li>
<li>端到端拥塞控制<ul>
<li>网络层不向端系统提供反馈</li>
<li>端系统通过观察丢包和延迟，自行推断拥塞的发生</li>
<li><font color="red">TCP采用此类方法</font></li>
</ul>
</li>
</ul>
<h2 id="tcp_10">TCP拥塞控制</h2>
<p>TCP使用端到端拥塞控制机制：发送方根据自己感知的网络拥塞程度，限制其发送速率</p>
<p><strong>如何感知</strong></p>
<ul>
<li>发送方利用丢包事件感知拥塞：<ol>
<li>拥塞造成丢包和分组延迟增大</li>
<li>无论是丢包还是分组延迟过大，对于发送端来说都是<font color="red">丢包</font>了</li>
</ol>
</li>
<li>丢包事件包括：<ol>
<li>重传定时器超时</li>
<li>发送端收到3个重复的ACK</li>
</ol>
</li>
</ul>
<p><strong>如何限制发送速度</strong></p>
<p>发送方使用拥塞窗口cwnd限制已发送未确认的数据量</p>
<p><img alt="a" src="../photos/20241128111858.png" width="250px" /></p>
<p>cwnd随发送方感知的网络拥塞程度而变化</p>
<p><strong>调整策略AIMD</strong></p>
<ul>
<li>乘性减（Multiplicative Decrease）<ol>
<li>发送方检测到丢包后，将cwnd的大小减半(但不能小于一个MSS)</li>
<li>目的：迅速减小发送速率，缓解拥塞</li>
</ol>
</li>
<li>加性增（Additive Increase）<ol>
<li>若无丢包，每经过一个RTT，将cwnd增大一个MSS，直到检测到丢包</li>
<li>目的：缓慢增大发送速率，避免振荡</li>
</ol>
</li>
</ul>
<p><strong>TCP慢启动</strong></p>
<ul>
<li>采用“加性增”增大发送窗口，太慢！<ol>
<li>在新建连接上，令cwnd = 1 MSS，起始速度= MSS/RTT</li>
<li>然而，网络中的可用带宽可能远大于MSS/RTT </li>
</ol>
</li>
<li>慢启动的基本思想：<ol>
<li>在新建连接上指数增大cwnd，直至检测到丢包(此时终止慢启动)</li>
<li>希望迅速增大cwnd至可用的发送速度</li>
</ol>
</li>
</ul>
<p><strong>慢启动具体实施</strong></p>
<ul>
<li>慢启动的策略：<ol>
<li>每经过一个RTT，将cwnd加倍</li>
</ol>
</li>
<li>慢启动的具体实施：<ol>
<li><font color="red">每收到一个ACK段，cwnd增加一个MSS</font></li>
<li>只要发送窗口允许，发送端可以立即发送下一个报文段</li>
</ol>
</li>
<li>特点：<ol>
<li>以一个很低的速率开始，按指数增大发送速率</li>
</ol>
</li>
</ul>
<p><strong>区分不同的丢包事件</strong></p>
<ul>
<li>超时：说明网络交付能力很差(更严重的情况)<ol>
<li>设置门限 =cwnd/2</li>
<li>cwnd=1MSS</li>
<li>使用慢启动增大cwnd至门限</li>
<li>使用AIMD调节cwnd</li>
</ol>
</li>
<li>收到3个重复的ACK：说明网络仍有一定的交付能力<ol>
<li>将cwnd降至一半</li>
<li>使用AIMD调节cwnd </li>
</ol>
</li>
</ul>
<p><strong>TCP拥塞控制的实现</strong></p>
<ul>
<li>发送方维护变量ssthresh </li>
<li>发生丢包时，ssthresh = cwnd/2</li>
<li>ssthresh是从慢启动转为拥塞避免的分水岭：<ol>
<li>cwnd低于门限时，执行慢启动</li>
<li>cwnd高于门限：执行拥塞避免</li>
</ol>
</li>
<li>拥塞避免阶段，拥塞窗口线性增长：<ol>
<li>每当收到ACK， cwnd = cwnd + MSS*(MSS/cwnd) <font color="red">[也就是说，只有收到所有的包才会增加一个MSS，是缓慢增加的]</font></li>
</ol>
</li>
<li>检测到3个重复的ACK后：<ol>
<li>TCP Reno实现： cwnd= ssthresh+3，线性增长(加3是实现细节，可以不管)</li>
<li>TCP Tahoe实现：cwnd=1 MSS，慢启动</li>
</ol>
</li>
</ul>
<p><img alt="a" src="../photos/20241128112953.png" width="250px" /></p>
<p><strong>TCP发送端的事件与动作</strong></p>
<p><img alt="a" src="../photos/20241128113508.png" width="500px" /></p>
<p><strong>TCP拥塞控制状态机</strong></p>
<p><img alt="a" src="../photos/20241128113813.png" width="500px" /></p>
<p><strong>无线传输中的问题</strong></p>
<p>无线传输中就算不拥塞也会有丢包问题的产生(因为传输错误而丢包)，此时的指示结果就不准确了，此时的错误判断会降低网络的利用率</p>
<p>解决方式：为了在无线网络中也能正常工作,拥塞控制算法观察到的丢包只能是那些因带宽不足造成的丢包,而不能把由于传输错误造成的丢包也算在内。这个问题的一种解决方案是通过使用无线链路上的重传机制把无线链路的丢包掩盖起来。例如,802.11使用停-等式协议来传递每个帧,在向上层报告丢包之前,如果需要会进行多次重传。在正常情况下,每个数据包的交付对高层是不可见的,尽管可能曾经发生过瞬间的传输错误。</p>
<p><img alt="a" src="../photos/20241128150609.png" width="400px" /></p>
<p>图中显示了一条由有线和无线链路组成的路径,传输层采用了屏蔽策略。有两个方面需要注意。首先,发送端并不一定要知道该路径包括一条无线链路,因为它所能看到的只是与它连接的有线链路。Intemet上的路径是异构的,而且不存在一种通用的方法用来告知发送端路经由什么链路组成。这样的现状加深了拥塞控制问题的复杂性,因为没有简单的方法使得无线链路采用一个协议而有线链路采用另一个协议。</p>
<div class="admonition note">
<p class="admonition-title">TCP性能分析</p>
<p>一个长期存活的TCP连接，平均吞吐量是多少？</p>
<ul>
<li>忽略慢启动阶段（该阶段时间很短），只考虑拥塞避免阶段</li>
<li>令W=发生丢包时的拥塞窗口，此时有：throughput = W/RTT</li>
<li>发生丢包后调整 cwnd=W/2，此时有：throughput = W/2RTT</li>
<li>假设在TCP连接的生命期内，RTT 和 W几乎不变，有：Average throughout = 0.75 W/RTT</li>
</ul>
</div>
<p><strong>TCP的公平性</strong></p>
<p>目标：如果K条TCP连接共享某条带宽为R的瓶颈链路，每条连接应具有平均速度R/K</p>
<ul>
<li>考虑两条竞争的连接（各种参数相同）共享带宽为R的链路:<ol>
<li>加性增：连接1和连接2按照相同的速率增大各自的拥塞窗口，得到斜率为1的直线</li>
<li>乘性减：连接1和连接2将各自的拥塞窗口减半   <br />
<img alt="a" src="../photos/20241128114544.png" width="200px" /></li>
</ol>
</li>
<li>更复杂的情形<ol>
<li>若相互竞争的TCP连接具有不同的参数（RTT、MSS等），不能保证公平性</li>
<li>若应用（如web）可以建立多条并行TCP连接，不能保证带宽在应用之间公平分配</li>
</ol>
</li>
</ul>
<details class="question">
<summary>一道思考题</summary>
<p>Consider the following figure. Assuming TCP Reno is the protocol experiencing the behavior, answer the following questions. In all cases, you should provide a short discussion justifying your answer.</p>
<p><img alt="a" src="../photos/20241128142459.png" width="500px" /></p>
<p>(1) Identify the intervals of time when TCP slow start is operating.</p>
<p>(2) Identify the intervals of time when TCP congestion avoidance is operating.</p>
<p>(3) After the 16th transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?</p>
<p>(4) After the 22nd transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?</p>
<p>(5) What is the initial value of Threshold at the first transmission round?</p>
<p>(6) What is the value of Threshold at the 18th transmission round?</p>
<p>(7) What is the value of Threshold at the 24th transmission round?</p>
<p>(8) Assuming a packet loss is detected after the 26th round by the receipt of a triple duplicate ACK, what will be the values of the cwnd and Threshold?</p>
<p>(9) Suppose TCP Tahoe is used (instead of TCP Reno), and assume that triple duplicate ACKs are received at the 16th round. What are the Threshold and cwnd at the 19th round?</p>
<details class="answer">
<summary>答案与解析</summary>
<p>(1) 慢启动部分 cwnd 是以指数形式增长的，所以答案是 <font color="red">[1, 6] 以及 [23, 26]</font></p>
<p>(2) 拥塞避免部分 cwnd 是以线性形式增长的，所以答案是 <font color="red">[6, 16] 以及 [17, 22]</font></p>
<p>(3) 在16轮后，cwnd 的大小下降了一半，并且采用的是 TCP Reno，所以是 <font color="red">a triple deplicate ACK</font></p>
<p>(4) 在22轮后，cwnd 的大小直接下降至1，所以是 <font color="red">a time out</font></p>
<p>(5) 第一轮中，cwnd 首先以指数增长的方式增长到32，然后进入线性增长阶段，所以<font color="red">第一轮中的 threshold 是32</font></p>
<p>(6) 第18轮中的 Threshold，其实就是第16轮之后的 Threshold，在第16轮之后，因为连续收到了3个重复的 ACK 导致 Threshold 减半，所以答案是<font color="red">32/2=16</font></p>
<p>(7) 第24轮中的 Threshold，其实就是第22轮之后的 Threshold，在第2轮之后，因为丢包导致 Threshold 减半，所以答案是<font color="red">(21+5)/2=13</font></p>
<p>(8) 如果在第 26 轮之后发生了连续收到3个重复的 ACK 的异常，根据 TCP Reno，这时的 cwnd 和 Threshold 都会减半，所以此时这两个变量的值都是<font color="red">(1*2*2*2)/2=4</font></p>
<p>(9) 要知道第19轮的情况，首先需要知道第17轮的情况，第16轮之后发生了连续收到3个重复的ACK包的异常，并且此时使用的是TCP Tahoe，所以此时Threshold 都会减半，并且 cwnd 会减小到1，也就是说第17轮的时候，cwnd = 1 并且 Threshold = 42/2 = 21。接下来进入指数增长阶段，所以第19轮时候的情况是这样的<font color="red">cwnd = 1*2*2 = 4, Threshold = 21</font></p>
</details>
</details>
<h2 id="_8">拥塞控制的发展</h2>
<h3 id="tcp-cubic">TCP CUBIC</h3>
<p><strong>经典TCP拥塞控制的性能问题</strong></p>
<p>TCP Reno线性增大拥塞窗口，探测当前可用网络带宽，即每经过一个RTT，拥塞窗口增加一个MSS；当端到端时延带宽乘积（BDP）较大时，拥塞窗口增长过慢，导致信道无法满载</p>
<p><img alt="a" src="../photos/20241205100229.png" width="450px" /></p>
<p><strong>BIC算法对满载窗口进行二分查找</strong></p>
<ul>
<li>如发生丢包时窗口大小是W1，为保持满载而不丢包，满载窗口应小于W1</li>
<li>如检测到丢包并将窗口乘性减小为W2 ，则满载窗口应大于W2</li>
<li>窗口更新受ACK时钟驱动，即以RTT为更新间隔时间</li>
<li>在ACK时钟的驱动下，将拥塞窗口置为(W1 + W2)/2(新的W2值)，不断逼近满载窗口</li>
<li>最大探查：如窗口再次达到W1而没有丢包，说明满载窗口大于W1 ，则以逼近W1的镜像过程增大拥塞窗口</li>
</ul>
<p><img alt="a" src="../photos/20241205110856.png" width="500px" /></p>
<div class="admonition danger">
<p class="admonition-title">BIC存在带宽不公平性问题</p>
<p>BIC以ACK时钟驱动拥塞窗口的更新，RTT较短的连接会更快到达满载窗口，占据更多的带宽，产生不公平性问题</p>
</div>
<p><strong>TCP CUBIC</strong></p>
<p>CUBIC将BIC算法连续化，用三次函数拟合BIC算法曲线，并且拥塞窗口成为距上次丢包的时间t的函数，t取值位于两次丢包之间，<font color="red">不再根据RTT间隔来确定调整窗口的时机，避免了RTT不公平问题</font></p>
<p><img alt="a" src="../photos/20241205111247.png" width="300px" /></p>
<h3 id="google-bbr">Google BBR</h3>
<p>瓶颈链路带宽BtlBw，决定了端到端路径上的最大数据投递速率。拥塞窗口大于BtlBw时，瓶颈链路处会形成排队，导致RTT延长(直至超时)</p>
<p><img alt="a" src="../photos/20241205140356.png" width="500px" /></p>
<p>先前学的TCP Reno是从开始丢包的时候才开始处理的，相对开始处理时间较晚，实际上可以早一些开始处理。</p>
<p><strong>BBR</strong></p>
<ul>
<li>瓶颈链路带宽BtlBw：不会引起路由器缓存排队的最大发送速率</li>
<li>RTprop：往返时间</li>
<li>BDP=BtlBw x RTprop</li>
<li>经典拥塞控制状态机以丢包事件为驱动，探测阶段将瓶颈链路上的缓冲区填满直至丢包，并以此为依据判断是否进行被动的乘性减小</li>
<li>BBR试图测量图中左侧优化点的BtlBw，尽量将cwnd收敛到实际BtlBw，从而避免出现丢包，属于主动探测</li>
</ul>
<p><strong>优化点的近似观测</strong></p>
<p>用过去10秒内的最小RTT(min RTT)和最大投递率(max BW)，分别近似RTprop和BtlBw，并依据这两个值估算当前BDP</p>
<p><img alt="a" src="../photos/20241205141032.png" width="500px" /></p>
<p>从图中可以看出，最小RTT(最低延迟测量需要保证链路队列为空)和最大投递率(测量最大带宽需要把瓶颈链路填满)两个值无法同时被测出</p>
<p><strong>BDP检测</strong></p>
<ul>
<li>启动阶段(START_UP)<ol>
<li>当连接建立时，类似TCP的慢启动，指数增加发送速率，尽可能快地占满管道</li>
<li>若经过三次发现投递率不再增长，说明已达到BtlBw，瓶颈链路处分组已开始排队(事实上此时占的是三倍BDP)   <br />
<img alt="a" src="../photos/20241205141411.png" width="300px" /></li>
</ol>
</li>
<li>排空阶段(DRAIN)<ol>
<li>指数降低发送速率（相当于是startup的逆过程），将多占的两倍buffer慢慢排空    <br />
<img alt="a" src="../photos/20241205141546.png" width="300px" /></li>
</ol>
</li>
<li>瓶颈带宽探测(PROBE_BW)<ol>
<li>进入稳定状态后, 先在一个RTT内增加发送速率，探测最大带宽</li>
<li>如果RTT没有变化，再减小发送速率，排空前一个RTT多发出来的包</li>
<li>后面6个周期使用更新后的估计带宽发送    <br />
<img alt="a" src="../photos/20241205141700.png" width="300px" /></li>
</ol>
</li>
<li>时延探测(PROBE_RTT)<ol>
<li>测得的RTprop作为基准，用以判断带宽检测阶段瓶颈链路中是否发生排队</li>
<li>每过10秒，如果估计的RTprop不变，就进入RTprop探测阶段，cwnd固定为4个包      <br />
<img alt="a" src="../photos/20241205142046.png" width="300px" /></li>
</ol>
</li>
</ul>
<p><strong>BBR状态机</strong></p>
<p><img alt="a" src="../photos/20241205142254.png" width="400px" /></p>
<h3 id="data-center-tcp">Data Center TCP</h3>
<p><strong>数据中心的通信模式</strong></p>
<p><font color="red">Partition/Aggregate</font>：Aggregator将上层应用任务划分给下层的worker执行</p>
<p><strong>数据中心流量特点</strong></p>
<ul>
<li>根据流量大小可分为<font color="red">时延敏感的短流(50KB-1MB)</font>和<font color="red">吞吐敏感的长流(1MB-50MB)</font></li>
<li>还存在大量<font color="red">突发流量(时间&lt;1s、大小&lt;2KB)</font></li>
</ul>
<p><strong>数据中心的性能问题</strong></p>
<ol>
<li>Incast<ul>
<li>在一个很短的时间内，大量流量同时到达交换机的一个端口，导致缓冲区被占满，最终导致丢包</li>
<li>在并发流量很大的情况下，即使每条流的包很小，也会产生Incast问题</li>
</ul>
</li>
<li>Queue Buildup<ul>
<li>长流和短流同时通过交换机的同一个端口时，由于长流占用较多的缓冲区空间，导致短流延迟增大，甚至丢包</li>
</ul>
</li>
<li>Buffer Pressure<ul>
<li>交换机的不同端口通常共享同一块缓冲区，即使长流和短流通过不同的端口，短流通过的端口也会出现缓冲区不足的问题</li>
</ul>
</li>
</ol>
<p><strong>数据中心传输层协议要求</strong></p>
<ul>
<li>容忍高突发流量</li>
<li>低时延</li>
<li>高吞吐</li>
</ul>
<p><strong>DCTCP核心思想</strong></p>
<ul>
<li>根据网络拥塞程度精细地减小发送窗口：一旦发现拥塞，发送窗口减至原窗口的(1-α/2)， α反映了拥塞程度，而TCP中α总为1</li>
<li>根据交换机队列的瞬时长度标记ECN(explicit congestion notification)，使用显式的拥塞反馈能够更好地控制突发流量</li>
</ul>
<p><strong>优点</strong></p>
<ul>
<li>容忍高突发流量<ul>
<li>DCTCP能将队列长度稳定地维持在一个很低的水平</li>
<li>采用激进的标记策略</li>
</ul>
</li>
<li>低时延</li>
<li>高吞吐<ul>
<li>DCTCP根据拥塞程度精确调节窗口</li>
</ul>
</li>
</ul>
<h3 id="dccp">DCCP</h3>
<p>UDP 没有拥塞控制机制，但是又想要使用 UDP，所以就有了DCCP = UDP + 拥塞控制</p>
<h2 id="_9">传输层协议的发展</h2>
<h3 id="mptcp">MPTCP</h3>
<p>解决同时使用多个网络接口来实现多路径传输的问题(比如手机同时使用WIFI和流量)</p>
<p><strong>优势</strong></p>
<ul>
<li>多径带宽聚合</li>
<li>提升传输的可靠性</li>
<li>支持链路的平滑切换</li>
</ul>
<p><strong>位置</strong></p>
<p>MPTCP位于套接字和TCP之间：应用程序通过套接字调用MPTCP，MPTCP向应用程序提供单条连接的抽象，因而对应用层透明。MPTCP连接是一个或多个子流的集合。</p>
<p><strong>MPTCP连接管理</strong></p>
<p>连接建立：首先初始化一条MPTCP连接(与建立常规TCP连接的过程相似)，然后将MPTCP的其它子流附加到已经存在的MPTCP连接上。</p>
<p><strong>MPTCP的数据调度</strong></p>
<p>在多路径传输中，发送端将属于同一个数据流的数据包调度到不同的路径上传输，由于不同路径的差异，这些数据包往往无法按照发送顺序到达接收端。乱序到达的数据包需暂存在接收缓存中，直到接收缓中的数据包能够按序交付给上层应用，这既影响了数据传输的实时性，又影响了网络的吞吐量。MPTCP根据拥塞窗口大小及路径延迟，将数据按比例分配给各个子流，尽力保证数据包按序到达接收端，降低数据乱序到达对网络性能产生的不利影响。</p>
<p><strong>MPTCP的拥塞控制</strong></p>
<p>目标</p>
<ol>
<li>提升吞吐量：多路径TCP连接的各个子流获得的总吞吐量，不应低于其最优路径上单路径TCP连接的吞吐量</li>
<li>公平性：多路径TCP连接在同一网络瓶颈处的多个子流，不能过多地侵占其它单路径TCP连接的带宽</li>
<li>均衡拥塞：多路径TCP连接应能在满足前两个准则的情况下，实现各个子流之间的负载均衡，尽可能将拥塞路径上的流量迁移到较好的路径上</li>
</ol>
<h3 id="quic">QUIC</h3>
<p><strong>TCP存在的问题</strong></p>
<p>TCP在操作系统内核中实现，应用无法对TCP进行修改，而操作系统的更新往往跟不上应用的需求和节奏，并且TCP体系握手时时延很大，而目前对低时延的要求越来越高。而且，TCP多流复用存在队头阻塞问题(TCP传输需要有序性，一旦出现丢包，后面的数据需要等丢失的包重传完成才能使用)。</p>
<p><strong>QUIC在网络体系结构中的位置</strong></p>
<p><img alt="a" src="../photos/20241205145711.png" width="400px" /></p>
<p>QUIC实现在用户态中，底层基于UDP实现。QUIC与应用的联系更加紧密，可以频繁地更新。</p>
<p><strong>QUIC包格式</strong></p>
<p><img alt="a" src="../photos/20241205150102.png" width="400px" /></p>
<ul>
<li>连接标识符(Connection ID)：用于对连接进行表示和识别</li>
<li>包号(Packet Number)：单调递增。即同一个连接中，每个QUIC包的包号都不一样</li>
</ul>
<p>QUIC底层使用UDP进行传输(QUIC包作为UDP地数据载荷)，IANA（互联网数字分配机构）建议QUIC使用UDP的443端口</p>
<p><strong>连接建立时延优化</strong></p>
<p><img alt="a" src="../photos/20241205150422.png" width="600px" /></p>
<p><strong>优势</strong></p>
<ul>
<li>明确的包序号和更精确的RTT(后者是由前者决定的)</li>
<li>IP地址/端口切换无需重新建立连接(QUIC使用Connection ID来表示每个连接，IP地址或端口的变化不影响对原有连接的识别)</li>
<li>由传输层对连接的切换进行管理</li>
<li>无队头阻塞的多流复用(在单个连接中，建立相互独立的多个QUIC流，某个流的数据包丢失不影响其它流的数据交付，可以减少不必要的等待)</li>
<li>QUIC易于部署和更新(整个QUIC包被加密传输，QUIC在用户态实现)</li>
</ul>







  
  






  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
  data-repo="NoneZJL/mymkdocs"
  data-repo-id="R_kgDOMETFiQ"
  data-category="Announcements"
  data-category-id="DIC_kwDOMETFic4Cjv-I"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async>
  </script>
  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      NoneZJL
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "navigation.tracking", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>