
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/Lessons/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/chapter6/">
      
      
        <link rel="prev" href="../chapter5/">
      
      
        <link rel="next" href="../chapter8/">
      
      
      <link rel="icon" href="../../../images/nothing.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>chapter6 | 进程同步 - NoneZJL的个人笔记</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    

      
    
<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#process-synchronization" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="NoneZJL的个人笔记" class="md-header__button md-logo" aria-label="NoneZJL的个人笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NoneZJL的个人笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              chapter6 | 进程同步
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NoneZJL/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NoneZJL's notebook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/%E8%AF%BE%E7%A8%8B%E4%BB%8B%E7%BB%8D/" class="md-tabs__link">
          
  
  课程

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Tools/mkdocs%E4%BD%BF%E7%94%A8/" class="md-tabs__link">
          
  
  工具

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  关于我

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NoneZJL的个人笔记" class="md-nav__button md-logo" aria-label="NoneZJL的个人笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NoneZJL的个人笔记
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NoneZJL/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NoneZJL's notebook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    课程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            课程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机系统原理
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            计算机系统原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/%E8%AF%BE%E7%A8%8B%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    课程介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 1 计算机抽象及相关技术
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 2 指令——计算机的语言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 3 计算机的算数运算
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 4 处理器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 5 大容量和高速度——开发存储器层次结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 6 输入输出系统
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机网络
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            计算机网络
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%86%85%E5%AE%B9%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内容介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/chapter01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/chapter03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据链路层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/chapter04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介质访问子层
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    操作系统
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            操作系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter5 | 进程调度
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    chapter6 | 进程同步
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    chapter6 | 进程同步
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consumer-producer-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Consumer-producer problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#race-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Race condition
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-critical-section-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Critical-Section Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Critical-Section Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      目的
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解决方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      同步机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="同步机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      单标志法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      双标志后检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      双标志前检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#petersons-solution" class="md-nav__link">
    <span class="md-ellipsis">
      Peterson’s Solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bakery-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Bakery Algorithm (面包房算法)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      硬件实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="硬件实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disable-interrupts" class="md-nav__link">
    <span class="md-ellipsis">
      Disable interrupts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testandset-instruction" class="md-nav__link">
    <span class="md-ellipsis">
      TestAndSet Instruction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-instruction" class="md-nav__link">
    <span class="md-ellipsis">
      Swap Instruction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex-locks" class="md-nav__link">
    <span class="md-ellipsis">
      Mutex Locks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      硬件实现方法总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      信号量机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信号量机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      信号量类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      信号量的使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      信号量的实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信号量的实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      忙等待
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      非忙等待
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      死锁问题和饥饿问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      实际问题的解决
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实际问题的解决">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bounded-buffer-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Bounded-Buffer Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readers-and-writers-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Readers and Writers Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dining-philosophers-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Dining-Philosophers Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitors" class="md-nav__link">
    <span class="md-ellipsis">
      Monitors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronization-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronization Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atomic-transactions" class="md-nav__link">
    <span class="md-ellipsis">
      Atomic Transactions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chapter8 | 主存
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/mkdocs%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/elasticsearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElasticSearch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于我
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consumer-producer-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Consumer-producer problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#race-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Race condition
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-critical-section-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Critical-Section Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Critical-Section Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      目的
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解决方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      同步机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="同步机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      单标志法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      双标志后检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      双标志前检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#petersons-solution" class="md-nav__link">
    <span class="md-ellipsis">
      Peterson’s Solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bakery-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Bakery Algorithm (面包房算法)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      硬件实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="硬件实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disable-interrupts" class="md-nav__link">
    <span class="md-ellipsis">
      Disable interrupts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testandset-instruction" class="md-nav__link">
    <span class="md-ellipsis">
      TestAndSet Instruction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-instruction" class="md-nav__link">
    <span class="md-ellipsis">
      Swap Instruction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex-locks" class="md-nav__link">
    <span class="md-ellipsis">
      Mutex Locks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      硬件实现方法总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      信号量机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信号量机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      信号量类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      信号量的使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      信号量的实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信号量的实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      忙等待
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      非忙等待
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      死锁问题和饥饿问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      实际问题的解决
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实际问题的解决">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bounded-buffer-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Bounded-Buffer Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readers-and-writers-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Readers and Writers Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dining-philosophers-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Dining-Philosophers Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitors" class="md-nav__link">
    <span class="md-ellipsis">
      Monitors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronization-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronization Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atomic-transactions" class="md-nav__link">
    <span class="md-ellipsis">
      Atomic Transactions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="process-synchronization">Process Synchronization</h1>
<h2 id="background">background</h2>
<p><strong>存在的问题：</strong>对共享数据的并发访问可能会导致数据的不一致性</p>
<p><strong>解决方式：</strong>维护数据一致性需要确保协作过程有序执行的机制</p>
<p><strong>进程同步：</strong>进程同步（Process Synchronization）是指在多进程或多线程环境中，为了确保多个进程或线程能够按照一定的顺序或条件正确地访问共享资源而采取的各种协调机制。</p>
<h3 id="consumer-producer-problem">Consumer-producer problem</h3>
<p><img alt="image-20241021104806164" src="../images/image-20241021104806164.png" /></p>
<ul>
<li>Employing an integer count to keep track of the number of full buffers.</li>
<li>Initially, count is set to 0.</li>
<li>It is incremented by the producer after it produces a new buffer .</li>
<li>It is decremented by the consumer after it consumes a buffer.</li>
<li>Producer and consumer perform concurrently.</li>
</ul>
<p><img alt="image-20241021105639804" src="../images/image-20241021105639804.png" /></p>
<p>​存在的一些问题，count++ 以及 count– 步骤可能会出现错误，在这两个步骤中，首先都会将内存中的值加载到寄存器中，在寄存器中进行加减后再将数据写回到寄存器。</p>
<ul>
<li>Consider this execution with “count = 5” initially:   </li>
<li>S0: producer execute <font color="blue">register1 = count   {register1 = 5}</font></li>
<li>S1: producer execute <font color="blue">register1 = register1 + 1   {register1 = 6} </font></li>
<li>S2: producer execute <font color="blue">count = register1 {count = 6}   </font></li>
<li>S3: consumer execute <font color="red">register2 = count   {register2 = 6} </font></li>
<li>S4: consumer execute <font color="red">register2 = register2 - 1   {register2 = 5} </font></li>
<li>S5: consumer execute count = <font color="red">register2  {count = 5 } </font></li>
</ul>
<p>​   一旦执行的顺序被打乱，那么就可能导致出错的情况。（调度导致的交错执行）</p>
<ul>
<li>Consider this execution interleaving with “count = 5” initially:  </li>
<li>S0: producer execute <font color="blue">register1 = count   {register1 = 5}</font></li>
<li>S1: producer execute <font color="blue">register1 = register1 + 1   {register1 = 6} </font></li>
<li>S2: consumer execute <font color="red">register2 = count   {register2 = 5} </font></li>
<li>S3: consumer execute <font color="red">register2 = register2 - 1   {register2 = 4} </font></li>
<li>S4: producer execute <font color="blue">count = register1   {count = 6 } </font></li>
<li>S5: consumer execute <font color="red">count = register2   {count = 4}</font></li>
</ul>
<h3 id="race-condition">Race condition</h3>
<p><strong>Race condition (竞态条件):</strong> A race condition is a situation in which a memory location is accessed concurrently, and at least one access is a write.</p>
<p><img alt="❓" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2753.svg" title=":question:" /> 对于访问共享的内核数据(shared kernel data)，非抢占的内核是否受竞态条件(race conditions)的影响？</p>
<ul>
<li><strong>Answer:</strong> 依然可能产生，比如多核进程以及统一写入的进程。</li>
</ul>
<h2 id="the-critical-section-problem">The Critical-Section Problem</h2>
<p>​临界区问题</p>
<h3 id="_1">目的</h3>
<ul>
<li>To design a protocol that the processes can use to cooperate</li>
</ul>
<p><img alt="image-20241021112059179" src="../images/image-20241021112059179.png" /></p>
<p>Entry section 用于判断能否进入临界区执行，里面的进程可能处于 running（正在判断）, ready（判断完但进不去临界区）, waiting（正在等待别的进程释放需要的资源） </p>
<p>Critical section 是临界区 </p>
<ul>
<li>对于Critical section 中的内容，当其中的各个部分具有关联时，则不能拆开，否则可以拆开。并且在可以拆开的情况下，拆开比较好，这样可以让更多的进程并发执行。</li>
</ul>
<p>Exit section 用于释放临界区资源</p>
<p>Remainder section 是剩余的程序</p>
<h3 id="_2">概念</h3>
<p>​<strong>临界资源：</strong>临界资源指的是在多线程或多进程环境中被多个线程或进程共享的资源。这些资源需要通过适当的同步机制来保护，以确保同一时刻只有一个线程或进程可以访问这些资源。</p>
<p>​<strong>临界区：</strong>临界区指的是程序中一个访问共用资源的程序片段。每个进程中访问临界资源的那段代码称为临界区。</p>
<p>​<strong>注意：</strong>CPU 不是临界资源，因为如果只有 CPU 是共享的，并不会导致数据的冲突。</p>
<h3 id="_3">解决方法</h3>
<ol>
<li>Mutual Exclusion (互斥) - If process <span class="arithmatex">\(P_i\)</span> is executing in its critical section, then no other processes can be executing in their critical sections</li>
<li>Progress (空闲让进) - If no process is executing in its critical section and there exist some processes that wish to enter their critical section, then the selection of the processes that will enter the critical section next cannot be postponed indefinitely
   当临界区空闲并且有进程希望进入临界区时，必然会有一个进程能够成功进入临界区</li>
<li>Bounded Waiting (有限等待) -  A bound must exist on the number of times that other processes are allowed to enter their critical sections after a process has made a request to enter its critical section and before that request is granted
   当一个进程发出进入临界区的请求之后，进入临界区之前的等待次数是有限的（当一个进程发出进入临界区的请求时，别的进程也可能发出了进入临界区的请求）</li>
<li>Assume that each process executes at a nonzero speed 
     进程不会停止</li>
<li>No assumption concerning relative speed of the N processes
     等待的次数是有限的，当时单次等待的时间是没有限制的，也就是说等待的总时间是没有限制的</li>
</ol>
<p><strong>总结：</strong>空闲让进、忙则等待（互斥）、有限等待、让权等待（一致无法获得进入临界区的权限时，让出等待的位置让别的进程有限进入临界区）</p>
<h2 id="_4">同步机制</h2>
<p><strong>软件方法</strong></p>
<h3 id="_5">单标志法</h3>
<p>​设置公共整型变量turn，指示允许进入临界区的进程编号，turn = i，允许 <span class="arithmatex">\(P_i\)</span> 进入临界区，进程退出临界区时交给另一个进程，turn = j</p>
<p><strong>代码实现</strong></p>
<p><img alt="image-20241023144341543" src="../images/image-20241023144341543.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？No，当一个进程 i 完成之后，turn 会变成    j，如果此时 j 一直不进入 critical section，那么 turn 一直保持在   j，i 无法再次进入 critical section</li>
<li>Bounded Waiting（有限等待）？Yes，等待次数为1，但是等待的次数可   能无限</li>
</ul>
</div>
<p><strong>特点</strong></p>
<ul>
<li>可实现两个进程轮替进入临界区</li>
<li>必须轮替进入，不满足空闲让进</li>
</ul>
<h3 id="_6">双标志后检查法</h3>
<p>​<strong>介绍：</strong>设置布尔型数组flag[2]，用来标记各进程进入临界区的意愿      flag[i]=true表示进程 <span class="arithmatex">\(P_i\)</span> 想进入</p>
<p>​<strong>过程：</strong>先表达自己进入临界区意愿再轮询对方是否想进入，确定对方不想进入后再进入访问结束退出后设置flag[i]=false，表示不想进入，允许对方进入</p>
<p><strong>代码实现</strong></p>
<p><img alt="image-20241023145244370" src="../images/image-20241023145244370.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？No，当两个进程同时变为 true 时，就会陷入死循环，没有进程能够进入 critical section</li>
<li>Bounded Waiting（有限等待）？Yes，等待次数为1，等待时间可能无限</li>
</ul>
</div>
<p><strong>特点</strong></p>
<ul>
<li>可能导致双方都不能进入</li>
<li>违反空闲让进</li>
</ul>
<h3 id="_7">双标志前检查法</h3>
<p>​<strong>介绍：</strong>设置布尔型数组flag[2]，用来标记各进程进入临界区的意愿      flag[i]=true表示进程 <span class="arithmatex">\(P_i\)</span> 想进入</p>
<p>​<strong>过程：</strong>进程进入临界区前先轮询对方是否想进入确定对方不想进入后再进入访问结束退出后设置flag[i]=false，表示不想进入，允许对方进入</p>
<p><strong>代码实现</strong></p>
<p><img alt="image-20241023150818345" src="../images/image-20241023150818345.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？No，同时想要进入，导致了两个进程同时进入 critical section</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？Yes，等待次数为1，等待时间可能无限</li>
</ul>
</div>
<p><strong>特点</strong></p>
<ul>
<li>不用交替进入</li>
<li>违反互斥</li>
</ul>
<h3 id="petersons-solution">Peterson’s Solution</h3>
<p>​将前面的法及方法进行结合，使用到了两个数据结构</p>
<p><strong>Idea</strong></p>
<p>​结合单标志法和双标志后检查法，首先表达自身意愿(flag[]=true)之后设置自身要进入(turn=0/1)；若双方互相确定对方都想进入时，turn只能等于一个值，因此会谦让对方进入若一方不想进入，则其flag[i]=false，对方可直接进入</p>
<p><strong>代码实现</strong></p>
<p><img alt="image-20241023151527843" src="../images/image-20241023151527843.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？Yes，等待次数为1</li>
</ul>
</div>
<div class="admonition danger">
<p class="admonition-title">存在问题</p>
<p><img alt="❓" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2753.svg" title=":question:" /> There are no guarantees that Peterson's solution works correctly on modern computer architectures.</p>
<p><strong>原因：</strong>现在计算机在编译代码的时候会对代码进行优化，load 会在 store 之前操作，导致算法的错误。（也就是说可能会先执行判断语句再执行上面的赋值语句，导致互斥条件无法满足）</p>
<p><strong>解决方式</strong></p>
<p>​Memory barrier (内存栅栏)</p>
<p><img alt="image-20241023152933832" src="../images/image-20241023152933832.png" /></p>
</div>
<h3 id="bakery-algorithm">Bakery Algorithm (面包房算法)</h3>
<p><strong>Dijkstra's concurrent programming problem:</strong></p>
<ol>
<li>任何时间，最多只能有一个进程进入 critical section；</li>
<li>每个进程最终都会进入 critical section；</li>
<li>每个进程都能停在 noncritical section；</li>
<li>不能对进程的速度做任何假设。</li>
</ol>
<p><strong>Idea</strong></p>
<p>​<strong>类似于餐馆取号和叫号的方式。取号接着上一个号码，叫号从小号开始叫号。</strong></p>
<ul>
<li>Before entering its critical section, process receives a number. Holder of the smallest number enters the critical section. </li>
<li>If processes <span class="arithmatex">\(P_i\)</span> and <span class="arithmatex">\(P_j\)</span> receive the same number, if i &lt; j, then <span class="arithmatex">\(P_i\)</span> is served first; else <span class="arithmatex">\(P_j\)</span> is served first. </li>
<li>The numbering scheme always generates numbers in increasing order of enumeration; e.g., 1, 2, 3, 3, 3, 3, 4, 5.</li>
</ul>
<p>​<strong>变量</strong></p>
<ul>
<li>boolean choosing[n]: 表示进程是否在取号；初始false。</li>
<li>int number[n]: 记录每个进程取到的号码；初始0。</li>
</ul>
<p>​<strong>比较方式</strong></p>
<ul>
<li>（a，b）＜（c，d）: (1) a＜c, or (2) a==c且b＜d</li>
</ul>
<p><strong>代码实现</strong></p>
<p><img alt="image-20241023153612948" src="../images/image-20241023153612948.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？Yes，等待次数为 n - 1</li>
</ul>
</div>
<h2 id="_8">硬件实现</h2>
<p><strong>Synchronization Hardware</strong></p>
<p><strong>方法分类</strong></p>
<ul>
<li>disable interrupts (关闭中断法)：通过关闭临界资源来屏蔽进程的访问</li>
<li>通过硬件设备的原子操作实现<ul>
<li>TestAndSet Instruction</li>
<li>Swap  Instruction</li>
<li>Mutex Locks</li>
</ul>
</li>
</ul>
<h3 id="disable-interrupts">Disable interrupts</h3>
<p>关中断法，也叫中断屏蔽法</p>
<p><strong>Idea</strong></p>
<ol>
<li>进入临界区前直接屏蔽中断，保证临界区资源顺利使用</li>
<li>使用完毕，打开中断</li>
</ol>
<p><img alt="a" class="center-image" src="../images/image-2024102801.png" /></p>
<p><strong>缺点</strong></p>
<ol>
<li>可能影响系统效率‌：滥用关中断会严重影响CPU执行效率，其锁住CPU可能导致原本一些短时间即可完成的需要等待开中断</li>
<li>不适用于多CPU系统‌：中断屏蔽法只适用于单CPU系统，在多CPU系统中无法有效同步各个CPU的操作‌。</li>
<li>安全性问题‌：滥用关中断权力可能导致严重后果，例如在关闭中断期间，一些重要的中断请求可能被错过，影响系统的稳定性和可靠性‌。</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">存在问题</p>
<p>不能保证操作的原子性</p>
<ul>
<li>Atomic = non-interruptable<ul>
<li>Either test memory word and set value</li>
<li>Or swap contents of two memory words</li>
</ul>
</li>
</ul>
</div>
<h3 id="testandset-instruction">TestAndSet Instruction</h3>
<p>Test and modify the content of a word atomically.</p>
<p>Shared boolean variable lock., initialized to false.</p>
<p><strong>伪代码</strong></p>
<p><img alt="a" class="center-image" src="../images/20241028103208.png" /></p>
<p><strong>代码实现</strong></p>
<p><img alt="a" class="center-image" src="../images/image-2024102802.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？No，运气不好可能会一直不能进入临界区</li>
</ul>
</div>
<h3 id="swap-instruction">Swap Instruction</h3>
<p><strong>伪代码</strong></p>
<p><img alt="a" class="center-image" src="../images/20241028102732.png" /></p>
<p><strong>实现思路</strong></p>
<ol>
<li>对每个临界资源，swap设置一个全局bool变量lock(初值为false)，每个进程设置局部变量key(初值为true)</li>
<li>进程调用swap()指令访问临界区，会交换key和lock的值，实现上锁，进入访问</li>
<li>退出时把lock重置为false</li>
</ol>
<p><strong>代码实现</strong></p>
<p>Shared Boolean variable lock initialized to FALSE; Each process has a local Boolean variable key.</p>
<p><img alt="a" class="center-image" src="../images/20241028103013.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？No，运气不好可能会一直不能进入临界区</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">拓展</p>
<p><strong>The compare_and_swap (CAS)  Instruction</strong></p>
<p><strong>定义</strong></p>
<p><img alt="a" src="../images/20241028103404.png" /></p>
<p><strong>属性</strong></p>
<ol>
<li>Executed atomically</li>
<li>Returns the original value of passed parameter value</li>
<li>Set  the variable value the value of the passed parameter new_value but only if *value == expected is true. That is, the swap takes place only under this condition.</li>
</ol>
<p><strong>代码实现</strong></p>
<p><img alt="a" class="center-image" src="../images/20241028103715.png" /></p>
<div class="admonition note">
<p class="admonition-title">条件满足</p>
<ul>
<li>Mutual Exclusion（互斥）？Yes</li>
<li>Progress（空闲让进）？Yes</li>
<li>Bounded Waiting（有限等待）？No，运气不好可能会一直不能进入临界区</li>
</ul>
</div>
<div class="admonition danger">
<p class="admonition-title">基于原子操作的共性问题</p>
<p>都满足不了有限等待 (Bounded Waiting)</p>
<details class="success">
<summary>解决方案</summary>
<p>基于排队等待的方法</p>
<p><img alt="a" src="../images/20241028104357.png" /></p>
</details>
</div>
</div>
<h3 id="mutex-locks">Mutex Locks</h3>
<ul>
<li>通过使用互斥锁来实现对数据的原子操作<ul>
<li>Protect a critical section  by <ul>
<li>First acquire() a lock </li>
<li>Then release() the lock</li>
</ul>
</li>
<li>Calls to acquire() and release() must be atomic<ul>
<li>Usually implemented via hardware atomic instructions such as compare-and-swap.</li>
</ul>
</li>
<li>But this solution requires busy waiting（不停空循环）<ul>
<li>This lock therefore called a spinlock （自旋锁）</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>代码实现</strong></p>
<p><img alt="a" class="center-image" src="../images/20241028112148.png" /></p>
<div class="admonition warning">
<p class="admonition-title">存在的问题</p>
<p>busy waiting (不应空循环)会导致CPU资源浪费，效率低下</p>
<p>以前被称为 spinlock (自旋锁)</p>
</div>
<h3 id="_9">硬件实现方法总结</h3>
<ul>
<li>优点<ol>
<li>适用于任意数目的进程，在单处理器或多处理器上</li>
<li>简单，容易验证其正确性</li>
<li>可以支持进程内存在多个临界区，只需为每个临界区设立一个布尔变量</li>
</ol>
</li>
<li>缺点<ol>
<li>耗费CPU时间，不能实现“让权等待”</li>
<li>可能不满足有限等待：从等待进程中随机选择一个进入临界区，有的进程可能一直选不上</li>
<li>可能死锁</li>
</ol>
</li>
</ul>
<h2 id="_10">信号量机制</h2>
<p><strong>SemaphoresClassic Problems of Synchronization</strong></p>
<ul>
<li>wait() and signal() 以前称为 P() and V() (荷兰语)</li>
<li>wait() 和 signal() 具体操作<ul>
<li>wait()
  <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">wait</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="c1">// no-op</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="n">S</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</code></pre></div></li>
<li>signal()
  <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">signal</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="n">S</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="_11">信号量类型</h3>
<ul>
<li>Counting semaphore (计数型) – integer value can range over an unrestricted domain</li>
<li>Binary semaphore (二进制型) – integer value can range only between 0 and 1; can be simpler to implement (可以认为是计数型的一种特殊形式，计数型有多少种状态，就使用多少个二进制数)<ul>
<li>Also known ad mutex locks</li>
</ul>
</li>
<li>Can implement a counting semaphore S as a binary semaphore</li>
<li>AND型信号量</li>
<li>信号量集</li>
</ul>
<h3 id="_12">信号量的使用</h3>
<p><strong>互斥</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">Semaphore</span><span class="w"> </span><span class="n">S</span><span class="p">;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">wait</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">Critical</span><span class="w"> </span><span class="n">Section</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">signal</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">Remainder</span><span class="w"> </span><span class="n">Section</span>
</code></pre></div>
<details class="question">
<summary>S的初始值应该是多少？</summary>
<p>应该是 1，否则没有进程能够进入临界区</p>
</details>
<p><strong>同步</strong></p>
<ul>
<li>P1 has a statement S1, P2 has S2</li>
<li>Statement S1 to be executed before S2</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">P1</span><span class="w">  </span><span class="n">S1</span><span class="p">;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="n">Signal</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">P2</span><span class="w">  </span><span class="nf">Wait</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="n">S2</span><span class="p">;</span>
</code></pre></div>
<details class="question">
<summary>S的初始值应该是多少？</summary>
<p>应该是 0，这样只有当 S1 执行后，S2 才会执行。</p>
</details>
<div class="admonition info">
<p class="admonition-title">实例</p>
<ul>
<li>四个房间，相同的key，需要几个信号量？</li>
</ul>
<details class="success">
<summary>答案</summary>
<p>1，对应生产者消费者模型，四个钥匙相同的房间代表着相同的可以支持四个进程同时访问的临界区资源，此时初始化一个信号量为4，当每个进程进来请求访问临界区资源时，如果信号量大于0，则信号量减去1并且访问临界区资源，否则不能访问临界区资源。当进程成功使用临界区资源之后，信号量加1。</p>
</details>
<ul>
<li>四个房间，每个房间各自的key，需要几个信号量？</li>
</ul>
<details class="success">
<summary>答案</summary>
<p>4，对应的还是生产者消费者模型，与上一个问题的区别是此时的四个房间对应的钥匙是不同的，可以理解为此时有四份临界区资源，并且每一份资源同时只能让一个进程访问。此时四个信号量初始化为1，接下俩的过程和上一个问题相同。</p>
<div class="admonition danger">
<p class="admonition-title">如果只用一个信号量会怎么样？</p>
<p>导致多个房间之间的访问冲突，无法保证互斥性</p>
</div>
</details>
</div>
<h3 id="_13">信号量的实现</h3>
<ul>
<li>确保 wait() 和 signal() 操作不能同时对一个信号量进行操作</li>
<li>此时信号量是临界资源问题<ul>
<li>可能会导致 busy waiting 问题</li>
</ul>
</li>
</ul>
<h4 id="_14">忙等待</h4>
<p><strong>实例</strong></p>
<p><img alt="a" src="../images/20241030001.png" width="500px" /></p>
<h4 id="_15">非忙等待</h4>
<ul>
<li>With each semaphore there is an associated waiting queue. Each semaphore has two data items:<ul>
<li>value (of type integer)</li>
<li>pointer to a linked-list of PCBs.</li>
</ul>
</li>
<li>Two operations (provided as basic system calls):<ul>
<li>block (sleep) – place the process invoking the operation on the appropriate waiting queue.</li>
<li>wakeup – remove one of processes in the waiting queue and place it in the ready queue.</li>
</ul>
</li>
</ul>
<p><img alt="a" class="width-and-center" src="../images/20241030002.png" /></p>
<div class="admonition warning">
<p class="admonition-title">非忙等与传统(忙等)的区别</p>
<p>S 可以取负值，表示队列里面正在排队的进程个数</p>
</div>
<p><strong>实例</strong></p>
<p><img alt="a" class="width-and-center" src="../images/20241030003.png" /></p>
<div class="admonition danger">
<p class="admonition-title">lost wakeup 问题</p>
<p>当wakeup()在212行与213行之间执行时，会导致wakeup的丢失。</p>
<div class="admonition success">
<p class="admonition-title">解决方式</p>
<p>将上锁操作挪到while(s-&gt;count == 0)上方，这样可以防止wakeup的丢失。</p>
<p><img alt="a" src="../images/20241030004.png" /></p>
<div class="admonition danger">
<p class="admonition-title">新的问题</p>
<p>此时p会陷入死循环</p>
<div class="admonition success">
<p class="admonition-title">解决方式</p>
<p><img alt="a" src="../images/20241030005.png" /></p>
</div>
</div>
</div>
</div>
<details class="abstract">
<summary>Busy waiting 和 No busy waiting</summary>
<p>待完成...</p>
</details>
<h3 id="_16">死锁问题和饥饿问题</h3>
<ul>
<li>Deadlock – two or more processes are waiting indefinitely for an event that can be caused by only one of the waiting processes</li>
</ul>
<p><img alt="a" src="../images/20241030006.png" /></p>
<p>P0 和 P1 同时执行完第一步，然后互相等待陷入死锁</p>
<ul>
<li>Starvation – indefinite blocking. A process may never be removed from the semaphore queue in which it is suspended.</li>
</ul>
<h3 id="_17">实际问题的解决</h3>
<ul>
<li>通常用信号量表示资源或临界区</li>
<li>
<p>信号量的物理含义</p>
<ul>
<li>S.value &gt;0 表示有S.value个资源可用;</li>
<li>S.value=0 表示无资源可用或表示不允许进程再进人临界区；</li>
<li>S.value&lt;0 则|S.value|表示在等待队列中进程的个数或表示等待进入临界区的进程个数。</li>
</ul>
</li>
<li>
<p>wait、signal操作必须成对出现，有一个wait操作就一定有一个signal操作一般情况下:当为互斥操作时，它们同处于同一进程;当为同步操作时，则不在同一进程中出现。</p>
</li>
<li>如果两个wait操作相邻，那么它们的顺序至关重要，而两个相邻的signal操作的顺序无关紧要。一个同步wait操作与一个互斥wait操作在一起时，<font color="red">同步wait操作在互斥wait操作前</font>，<font color="blue">否则可能导致死锁问题</font>。</li>
</ul>
<h4 id="bounded-buffer-problem">Bounded-Buffer Problem</h4>
<p>有界缓冲区问题：消费者判断有没有，生产者判断满没满</p>
<ul>
<li>N buffers, each can hold one item</li>
</ul>
<div class="admonition info">
<p class="admonition-title">How many semaphores?</p>
<ul>
<li>Semaphore <font color="red">mutex</font> initialized to the value 1</li>
<li>Semaphore <font color="red">full</font> initialized to the value 0, counting full items</li>
<li>Semaphore <font color="red">empty</font> initialized to the value N, counting empty items.</li>
</ul>
</div>
<p><strong>具体实现</strong></p>
<p><img alt="a" src="../images/2024103007.png" /></p>
<h4 id="readers-and-writers-problem">Readers and Writers Problem</h4>
<p>读者写者问题：可以允许多个读者同时阅读数据集，但是同一时间只能有一个写者在写数据集。并且当读者在读取数据集时，写者不能对数据集进行写操作。</p>
<ul>
<li>A data set is shared among a number of concurrent processes<ul>
<li>Readers – only read the data set; they do not perform any updates</li>
<li>Writers – can both read and write.</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">共享的变量</p>
<ul>
<li>Data set</li>
<li>Semaphore mutex initialized to 1, to ensure mutual exclusion when readcount is updated.</li>
<li>Semaphore wrt initialized to 1.</li>
<li>Integer readcount initialized to 0.</li>
</ul>
</div>
<p><strong>写者进程</strong></p>
<p><img alt="a" src="../images/20241030008.png" width="250px" /></p>
<p><strong>读者进程</strong></p>
<p><img alt="a" src="../images/20241030009.png" width="500px" /></p>
<h4 id="dining-philosophers-problem">Dining-Philosophers Problem</h4>
<p>哲学家就餐问题：五个哲学家围在桌前，可以选择思考或吃饭，每个哲学家左右两侧各有一根筷子，当他想吃饭时当且仅当拿到两根筷子时才能吃饭</p>
<div class="admonition info">
<p class="admonition-title">共享的变量</p>
<ul>
<li>Bowl of rice (data set)</li>
<li>Semaphore chopstick [5] initialized to 1</li>
</ul>
</div>
<p><strong>实现方式</strong></p>
<p><img alt="a" src="../images/20241030010.png" width="500px" /></p>
<div class="admonition danger">
<p class="admonition-title">死锁问题</p>
<p>所有哲学家同时拿起自己左侧的筷子</p>
</div>
<h2 id="monitors">Monitors</h2>
<h2 id="synchronization-examples">Synchronization Examples</h2>
<h2 id="atomic-transactions">Atomic Transactions</h2>







  
  






  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
  data-repo="NoneZJL/mymkdocs"
  data-repo-id="R_kgDOMETFiQ"
  data-category="Announcements"
  data-category-id="DIC_kwDOMETFic4Cjv-I"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async>
  </script>
  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      NoneZJL
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "navigation.tracking"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>